<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.serendipity.model.BoardDAO">
	<insert id="write">
	 INSERT INTO board(board_num, user_num, board_title, board_content, board_picture1, board_picture2, 
	 board_picture3, board_picture4, board_picture5,
	 board_capacity, board_date, board_latitude, board_longitude, local_code, category_num, price, 
	 meeting_Place, meeting_Address) 
	 VALUES( board_seq.NEXTVAL, #{user_num}, #{board_title}, #{board_content}, #{board_picture1},
	 #{board_picture2}, #{board_picture3}, #{board_picture4}, #{board_picture5},
	 1, #{board_date}, #{board_latitude}, #{board_longitude}, '02', 1, #{price}, 
	 #{meeting_place}, #{meeting_address})
	</insert>
	
	<select id="getBoardList" resultType="kr.co.serendipity.model.BoardDTO">
     SELECT * FROM
               ( SELECT ROWNUM NUM, N.* FROM 
                     ( SELECT * FROM BOARD where category_num=1 ORDER BY BOARD_NUM DESC) N
                ) WHERE NUM BETWEEN 1 + (#{page}-1)*6 AND 6 + (#{page}-1)*6
    </select>
    
    <select id="getListCount" resultType="Integer">
       SELECT count(*) FROM board where category_num=1
    </select>
    
    <select id="getBoardDetail" resultType="kr.co.serendipity.model.BoardDTO">
       SELECT * FROM board where board_num=#{board_num}
    </select>
    
    <insert id="Gwrite">
	 INSERT INTO board(board_num, user_num, board_title, board_content, board_picture1, board_picture2, 
	 board_picture3, board_picture4, board_picture5,
	 board_capacity, board_date, board_latitude, board_longitude, local_code, category_num, price, 
	 meeting_place,meeting_address)
	 VALUES( board_seq.NEXTVAL, #{user_num}, #{board_title}, #{board_content},  #{board_picture1},
	 #{board_picture2}, #{board_picture3}, #{board_picture4}, #{board_picture5}, 
	 #{board_capacity}, #{board_date} , #{board_latitude}, #{board_longitude}, '02', 2, #{price}, 
	 #{meeting_place}, #{meeting_address})
	</insert>

	<select id="getGBoardList" resultType="kr.co.serendipity.model.BoardDTO">
     SELECT * FROM
               ( SELECT ROWNUM NUM, N.* FROM 
                     ( SELECT * FROM BOARD where category_num=2 ORDER BY BOARD_NUM DESC) N
                ) WHERE NUM BETWEEN 1 + (#{page}-1)*6 AND 6 + (#{page}-1)*6
    </select>
    
    <select id="getGListCount" resultType="Integer">
       SELECT count(*) FROM board where category_num=2
    </select>
    
    <delete id="deleteBoard" >
       DELETE board WHERE board_num=#{board_num}
    </delete>

 	<select id="getIndexTravelerRecent" resultType="kr.co.serendipity.model.BoardDTO">
 		SELECT * FROM( SELECT ROWNUM NUM, N.* FROM (SELECT * FROM BOARD where category_num=1 ORDER BY BOARD_NUM DESC) N) WHERE NUM <![CDATA[ <= ]]>4
 	</select>
 	
 	<select id="getIndexGuideRecent" resultType="kr.co.serendipity.model.BoardDTO">
 		SELECT * FROM( SELECT ROWNUM NUM, N.* FROM 
		( SELECT * FROM BOARD where category_num=2 ORDER BY BOARD_NUM DESC) N) 
		WHERE NUM <![CDATA[ <= ]]>4
 	</select>
 	
 	<select id="getWriterDetail" resultType="kr.co.serendipity.model.MemberDTO">
 		select * from member where user_num=#{user_num}
 	</select>
 	
 	<update id="update">
	 update board set user_num=#{user_num}, 
	 board_title=#{board_title}, board_content=#{board_content}, 
	 board_capacity=1, board_date=#{board_date}, board_latitude=#{board_latitude},
	 meeting_place=#{meeting_place}, meeting_address=#{meeting_address}, 
	 board_longitude=#{board_longitude}, local_code='02', category_num=1, price=#{price} 
	 where board_num=#{board_num}
	</update>
	
	<update id="picUpdate1">
		update board set board_picture1=#{board_picture1} where board_num=#{board_num}
	</update>
	
	<update id="picUpdate2">
		update board set board_picture2=#{board_picture2} where board_num=#{board_num}
	</update>
	
	<update id="picUpdate3">
		update board set board_picture3=#{board_picture3} where board_num=#{board_num}
	</update>
	
	<update id="picUpdate4">
		update board set board_picture4=#{board_picture4} where board_num=#{board_num}
	</update>
	
	<update id="picUpdate5">
		update board set board_picture5=#{board_picture5} where board_num=#{board_num}
	</update>
	
	<select id="picSearch" resultType="kr.co.serendipity.model.BoardDTO">
       SELECT * FROM board where board_num=#{board_num}
    </select>
	
	<update id="Gupdate">
	 update board set user_num=#{user_num}, 
	 board_title=#{board_title}, board_content=#{board_content}, 
	 board_capacity=#{board_capacity}, board_date=#{board_date}, board_latitude=#{board_latitude}, 
	 meeting_place=#{meeting_place}, meeting_address=#{meeting_address},
	 board_longitude=#{board_longitude}, local_code='02', category_num=2, price=#{price} 
	 where board_num=#{board_num}
	</update>
	
	 <insert id="travelerParty">
	 INSERT INTO PARTICIPANT(parti_num, board_num, user_num, STATE)
	 VALUES(parti_seq.NEXTVAL, #{board_num}, #{user_num}, 'wait')
	</insert>
	
</mapper>